Traceback (most recent call last):
  File "/app/liucd/Crop/code/step2_lowerspacing.py", line 26, in <module>
    from monai.handlers.utils import from_engine
  File "/app/data/anaconda/lib/python3.9/site-packages/monai/handlers/__init__.py", line 15, in <module>
    from .confusion_matrix import ConfusionMatrix
  File "/app/data/anaconda/lib/python3.9/site-packages/monai/handlers/confusion_matrix.py", line 14, in <module>
    from monai.handlers.ignite_metric import IgniteMetric
  File "/app/data/anaconda/lib/python3.9/site-packages/monai/handlers/ignite_metric.py", line 32, in <module>
    class IgniteMetric(Metric):  # type: ignore[valid-type, misc] # due to optional_import
  File "/app/data/anaconda/lib/python3.9/site-packages/monai/utils/module.py", line 344, in __getattr__
    raise self._exception
  File "/app/data/anaconda/lib/python3.9/site-packages/monai/utils/module.py", line 303, in optional_import
    pkg = __import__(module)  # top level module
monai.utils.module.OptionalImportError: from ignite.metrics import Metric (No module named 'ignite').

For details about installing the optional dependencies, please visit:
    https://docs.monai.io/en/latest/installation.html#installing-the-recommended-dependencies
/app/data/anaconda/envs/monai-1.0.1/lib/python3.8/site-packages/monai/utils/deprecate_utils.py:107: FutureWarning: <class 'monai.transforms.utility.array.AddChannel'>: Class `AddChannel` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.
  warn_deprecated(obj, msg, warning_category)
{'image': '/app/liucd/Crop/crop_image/ATM_703_0000.nii.gz', 'label': '/app/liucd/Crop/crop_label/ATM_703_0000.nii.gz'}
240 60
Loading dataset:   0%|          | 0/240 [00:00<?, ?it/s]Loading dataset:   0%|          | 1/240 [00:14<55:50, 14.02s/it]Loading dataset:   1%|▏         | 3/240 [00:17<19:09,  4.85s/it]Loading dataset:   2%|▏         | 5/240 [00:17<09:45,  2.49s/it]Loading dataset:   3%|▎         | 7/240 [00:25<11:29,  2.96s/it]Loading dataset:   4%|▍         | 9/240 [00:27<08:41,  2.26s/it]Loading dataset:   4%|▍         | 10/240 [00:30<09:21,  2.44s/it]Loading dataset:   5%|▍         | 11/240 [00:34<10:55,  2.86s/it]Loading dataset:   5%|▌         | 13/240 [00:37<08:41,  2.30s/it]Loading dataset:   6%|▋         | 15/240 [00:41<07:56,  2.12s/it]Loading dataset:   7%|▋         | 17/240 [00:43<06:47,  1.83s/it]Loading dataset:   8%|▊         | 18/240 [00:43<05:32,  1.50s/it]Loading dataset:   8%|▊         | 19/240 [00:48<08:18,  2.26s/it]Loading dataset:   9%|▉         | 21/240 [00:50<06:09,  1.69s/it]Loading dataset:  10%|▉         | 23/240 [00:56<07:40,  2.12s/it]Loading dataset:  10%|█         | 25/240 [01:04<10:09,  2.83s/it]Loading dataset:  12%|█▏        | 29/240 [01:07<06:07,  1.74s/it]Loading dataset:  12%|█▎        | 30/240 [01:08<05:44,  1.64s/it]Loading dataset:  13%|█▎        | 31/240 [01:12<07:41,  2.21s/it]Loading dataset:  13%|█▎        | 32/240 [01:14<07:05,  2.05s/it]Loading dataset:  14%|█▍        | 34/240 [01:18<06:53,  2.01s/it]Loading dataset:  15%|█▍        | 35/240 [01:21<07:28,  2.19s/it]Loading dataset:  15%|█▌        | 36/240 [01:24<08:01,  2.36s/it]Loading dataset:  15%|█▌        | 37/240 [01:26<08:10,  2.41s/it]Loading dataset:  16%|█▌        | 38/240 [01:28<07:24,  2.20s/it]Loading dataset:  17%|█▋        | 40/240 [01:30<05:53,  1.77s/it]Loading dataset:  17%|█▋        | 41/240 [01:32<05:50,  1.76s/it]Loading dataset:  18%|█▊        | 42/240 [01:35<06:40,  2.02s/it]Loading dataset:  18%|█▊        | 44/240 [01:37<05:31,  1.69s/it]Loading dataset:  19%|█▉        | 45/240 [01:37<04:24,  1.36s/it]Loading dataset:  19%|█▉        | 46/240 [01:41<06:08,  1.90s/it]Loading dataset:  20%|█▉        | 47/240 [01:43<06:15,  1.95s/it]Loading dataset:  20%|██        | 48/240 [01:53<13:22,  4.18s/it]Loading dataset:  21%|██        | 50/240 [01:53<07:31,  2.38s/it]Loading dataset:  22%|██▏       | 52/240 [02:03<10:38,  3.40s/it]Loading dataset:  23%|██▎       | 55/240 [02:04<06:13,  2.02s/it]Loading dataset:  23%|██▎       | 56/240 [02:06<05:59,  1.95s/it]Loading dataset:  24%|██▍       | 57/240 [02:07<05:15,  1.73s/it]Loading dataset:  24%|██▍       | 58/240 [02:11<06:39,  2.19s/it]Loading dataset:  25%|██▍       | 59/240 [02:11<05:20,  1.77s/it]Loading dataset:  25%|██▌       | 60/240 [02:13<05:48,  1.93s/it]Loading dataset:  25%|██▌       | 61/240 [02:16<06:16,  2.11s/it]Loading dataset:  26%|██▌       | 62/240 [02:17<05:04,  1.71s/it]Loading dataset:  26%|██▋       | 63/240 [02:18<04:15,  1.45s/it]Loading dataset:  27%|██▋       | 64/240 [02:24<08:17,  2.83s/it]Loading dataset:  27%|██▋       | 65/240 [02:24<05:57,  2.04s/it]Loading dataset:  28%|██▊       | 66/240 [02:26<06:24,  2.21s/it]Loading dataset:  28%|██▊       | 68/240 [02:31<06:17,  2.20s/it]Loading dataset:  29%|██▉       | 69/240 [02:32<05:20,  1.88s/it]Loading dataset:  29%|██▉       | 70/240 [02:36<06:42,  2.37s/it]Loading dataset:  30%|██▉       | 71/240 [02:36<05:23,  1.91s/it]Loading dataset:  30%|███       | 72/240 [02:45<10:53,  3.89s/it]Loading dataset:  31%|███       | 74/240 [02:45<06:03,  2.19s/it]Loading dataset:  31%|███▏      | 75/240 [02:45<04:39,  1.69s/it]Loading dataset:  32%|███▏      | 76/240 [02:50<06:22,  2.33s/it]Loading dataset:  32%|███▎      | 78/240 [02:54<06:00,  2.22s/it]Loading dataset:  33%|███▎      | 79/240 [03:06<11:53,  4.43s/it]Loading dataset:  33%|███▎      | 80/240 [03:06<09:00,  3.38s/it]Loading dataset:  35%|███▌      | 84/240 [03:13<06:26,  2.48s/it]Loading dataset:  36%|███▌      | 86/240 [03:14<04:42,  1.84s/it]Loading dataset:  36%|███▋      | 87/240 [03:15<04:24,  1.73s/it]Loading dataset:  37%|███▋      | 88/240 [03:18<04:54,  1.94s/it]Loading dataset:  38%|███▊      | 90/240 [03:26<06:37,  2.65s/it]Loading dataset:  38%|███▊      | 91/240 [03:32<08:18,  3.35s/it]Loading dataset:  40%|████      | 96/240 [03:33<03:37,  1.51s/it]Loading dataset:  40%|████      | 97/240 [03:34<03:32,  1.49s/it]Loading dataset:  41%|████      | 98/240 [03:38<04:15,  1.80s/it]Loading dataset:  41%|████▏     | 99/240 [03:48<08:16,  3.52s/it]Loading dataset:  43%|████▎     | 103/240 [03:49<04:11,  1.83s/it]Loading dataset:  44%|████▍     | 105/240 [03:52<03:55,  1.74s/it]Loading dataset:  45%|████▌     | 108/240 [03:56<03:21,  1.53s/it]Loading dataset:  45%|████▌     | 109/240 [03:56<03:00,  1.37s/it]Loading dataset:  46%|████▌     | 110/240 [03:58<03:14,  1.49s/it]Loading dataset:  46%|████▋     | 111/240 [04:04<04:49,  2.25s/it]Loading dataset:  48%|████▊     | 115/240 [04:04<02:20,  1.12s/it]Loading dataset:  48%|████▊     | 116/240 [04:05<02:21,  1.14s/it]Loading dataset:  49%|████▉     | 117/240 [04:09<03:09,  1.54s/it]Loading dataset:  50%|████▉     | 119/240 [04:15<04:06,  2.04s/it]Loading dataset:  50%|█████     | 120/240 [04:15<03:31,  1.77s/it]Loading dataset:  51%|█████     | 122/240 [04:16<02:28,  1.26s/it]Loading dataset:  52%|█████▏    | 124/240 [04:19<02:25,  1.25s/it]Loading dataset:  52%|█████▏    | 125/240 [04:19<01:58,  1.03s/it]Loading dataset:  52%|█████▎    | 126/240 [04:23<03:27,  1.82s/it]Loading dataset:  53%|█████▎    | 127/240 [04:29<05:11,  2.76s/it]Loading dataset:  53%|█████▎    | 128/240 [04:31<04:40,  2.50s/it]Loading dataset:  55%|█████▍    | 131/240 [04:32<02:29,  1.37s/it]Loading dataset:  55%|█████▌    | 133/240 [04:35<02:30,  1.41s/it]Loading dataset:  56%|█████▌    | 134/240 [04:41<04:01,  2.28s/it]Loading dataset:  57%|█████▋    | 136/240 [04:41<02:38,  1.53s/it]Loading dataset:  57%|█████▋    | 137/240 [04:42<02:17,  1.33s/it]Loading dataset:  57%|█████▊    | 138/240 [04:44<02:35,  1.53s/it]Loading dataset:  58%|█████▊    | 140/240 [04:49<03:06,  1.87s/it]Loading dataset:  59%|█████▉    | 141/240 [04:53<04:04,  2.47s/it]Loading dataset:  59%|█████▉    | 142/240 [04:54<03:16,  2.01s/it]Loading dataset:  60%|██████    | 145/240 [04:55<02:00,  1.27s/it]Loading dataset:  61%|██████    | 146/240 [04:58<02:29,  1.59s/it]Loading dataset:  61%|██████▏   | 147/240 [04:59<02:11,  1.41s/it]Loading dataset:  62%|██████▏   | 148/240 [05:03<02:56,  1.92s/it]Loading dataset:  62%|██████▏   | 149/240 [05:14<06:23,  4.21s/it]Loading dataset:  65%|██████▍   | 155/240 [05:17<02:21,  1.66s/it]Loading dataset:  65%|██████▌   | 157/240 [05:19<02:11,  1.59s/it]Loading dataset:  66%|██████▌   | 158/240 [05:20<01:57,  1.44s/it]Loading dataset:  66%|██████▋   | 159/240 [05:24<02:37,  1.95s/it]Loading dataset:  67%|██████▋   | 160/240 [05:29<03:13,  2.42s/it]Loading dataset:  67%|██████▋   | 161/240 [05:29<02:42,  2.05s/it]Loading dataset:  68%|██████▊   | 162/240 [05:33<03:03,  2.35s/it]Loading dataset:  68%|██████▊   | 163/240 [05:40<04:33,  3.55s/it]Loading dataset:  69%|██████▉   | 166/240 [05:47<03:37,  2.94s/it]Loading dataset:  70%|███████   | 169/240 [05:49<02:24,  2.03s/it]Loading dataset:  71%|███████▏  | 171/240 [05:58<03:05,  2.69s/it]Loading dataset:  72%|███████▎  | 174/240 [06:00<02:10,  1.97s/it]Loading dataset:  73%|███████▎  | 176/240 [06:03<01:55,  1.80s/it]Loading dataset:  74%|███████▍  | 177/240 [06:05<01:51,  1.77s/it]Loading dataset:  74%|███████▍  | 178/240 [06:16<03:45,  3.64s/it]Loading dataset:  75%|███████▌  | 180/240 [06:20<02:57,  2.96s/it]Loading dataset:  76%|███████▌  | 182/240 [06:23<02:23,  2.47s/it]Loading dataset:  76%|███████▋  | 183/240 [06:23<01:58,  2.08s/it]Loading dataset:  77%|███████▋  | 185/240 [06:25<01:35,  1.73s/it]Loading dataset:  78%|███████▊  | 186/240 [06:27<01:35,  1.76s/it]Loading dataset:  78%|███████▊  | 187/240 [06:31<01:59,  2.25s/it]Loading dataset:  78%|███████▊  | 188/240 [06:32<01:37,  1.88s/it]Loading dataset:  79%|███████▉  | 189/240 [06:35<01:55,  2.26s/it]Loading dataset:  79%|███████▉  | 190/240 [06:37<01:44,  2.08s/it]Loading dataset:  80%|████████  | 192/240 [06:38<01:10,  1.47s/it]Loading dataset:  80%|████████  | 193/240 [06:41<01:22,  1.75s/it]Loading dataset:  81%|████████  | 194/240 [06:46<02:01,  2.63s/it]Loading dataset:  81%|████████▏ | 195/240 [06:48<01:48,  2.40s/it]Loading dataset:  82%|████████▏ | 196/240 [06:50<01:41,  2.32s/it]Loading dataset:  82%|████████▏ | 197/240 [06:52<01:36,  2.25s/it]Loading dataset:  82%|████████▎ | 198/240 [06:53<01:13,  1.74s/it]Loading dataset:  83%|████████▎ | 199/240 [06:54<01:10,  1.71s/it]Loading dataset:  83%|████████▎ | 200/240 [07:05<02:54,  4.37s/it]Loading dataset:  84%|████████▍ | 201/240 [07:14<03:42,  5.70s/it]Loading dataset:  84%|████████▍ | 202/240 [07:19<03:27,  5.46s/it]Loading dataset:  86%|████████▋ | 207/240 [07:22<01:14,  2.26s/it]Loading dataset:  87%|████████▋ | 208/240 [07:23<01:04,  2.02s/it]Loading dataset:  88%|████████▊ | 210/240 [07:25<00:47,  1.59s/it]Loading dataset:  88%|████████▊ | 211/240 [07:25<00:42,  1.45s/it]Loading dataset:  89%|████████▉ | 213/240 [07:27<00:35,  1.30s/it]Loading dataset:  89%|████████▉ | 214/240 [07:28<00:28,  1.11s/it]Loading dataset:  90%|████████▉ | 215/240 [07:31<00:40,  1.63s/it]Loading dataset:  90%|█████████ | 216/240 [07:36<00:56,  2.37s/it]Loading dataset:  90%|█████████ | 217/240 [07:39<00:57,  2.48s/it]Loading dataset:  92%|█████████▏| 221/240 [07:40<00:24,  1.27s/it]Loading dataset:  92%|█████████▎| 222/240 [07:42<00:24,  1.39s/it]Loading dataset:  93%|█████████▎| 223/240 [07:44<00:23,  1.40s/it]Loading dataset:  93%|█████████▎| 224/240 [07:46<00:26,  1.65s/it]Loading dataset:  94%|█████████▍| 225/240 [07:51<00:33,  2.26s/it]Loading dataset:  94%|█████████▍| 226/240 [07:52<00:29,  2.09s/it]Loading dataset:  95%|█████████▍| 227/240 [07:55<00:29,  2.26s/it]Loading dataset:  96%|█████████▌| 230/240 [07:56<00:13,  1.32s/it]Loading dataset:  96%|█████████▋| 231/240 [07:57<00:10,  1.20s/it]Loading dataset:  97%|█████████▋| 232/240 [07:58<00:08,  1.12s/it]Loading dataset:  97%|█████████▋| 233/240 [08:05<00:17,  2.46s/it]Loading dataset:  98%|█████████▊| 236/240 [08:05<00:04,  1.22s/it]Loading dataset:  99%|█████████▉| 237/240 [08:07<00:04,  1.41s/it]Loading dataset:  99%|█████████▉| 238/240 [08:08<00:02,  1.28s/it]Loading dataset: 100%|█████████▉| 239/240 [08:10<00:01,  1.43s/it]Loading dataset: 100%|██████████| 240/240 [08:10<00:00,  2.04s/it]
Loading dataset:   0%|          | 0/60 [00:00<?, ?it/s]Loading dataset:   2%|▏         | 1/60 [00:10<10:23, 10.57s/it]Loading dataset:   3%|▎         | 2/60 [00:10<04:18,  4.45s/it]Loading dataset:   7%|▋         | 4/60 [00:12<02:01,  2.16s/it]Loading dataset:   8%|▊         | 5/60 [00:15<02:10,  2.37s/it]Loading dataset:  10%|█         | 6/60 [00:18<02:31,  2.80s/it]Loading dataset:  12%|█▏        | 7/60 [00:21<02:28,  2.81s/it]Loading dataset:  13%|█▎        | 8/60 [00:21<01:43,  1.99s/it]Loading dataset:  17%|█▋        | 10/60 [00:23<01:15,  1.52s/it]Loading dataset:  18%|█▊        | 11/60 [00:30<02:14,  2.74s/it]Loading dataset:  22%|██▏       | 13/60 [00:30<01:17,  1.64s/it]Loading dataset:  23%|██▎       | 14/60 [00:31<01:05,  1.43s/it]Loading dataset:  25%|██▌       | 15/60 [00:34<01:23,  1.86s/it]Loading dataset:  27%|██▋       | 16/60 [00:37<01:35,  2.17s/it]Loading dataset:  30%|███       | 18/60 [00:39<01:07,  1.61s/it]Loading dataset:  32%|███▏      | 19/60 [00:42<01:20,  1.96s/it]Loading dataset:  33%|███▎      | 20/60 [00:45<01:26,  2.17s/it]Loading dataset:  37%|███▋      | 22/60 [00:45<00:54,  1.43s/it]Loading dataset:  38%|███▊      | 23/60 [00:47<00:56,  1.52s/it]Loading dataset:  40%|████      | 24/60 [00:49<00:56,  1.57s/it]Loading dataset:  42%|████▏     | 25/60 [00:50<00:54,  1.57s/it]Loading dataset:  43%|████▎     | 26/60 [00:51<00:44,  1.32s/it]Loading dataset:  45%|████▌     | 27/60 [00:53<00:45,  1.38s/it]Loading dataset:  47%|████▋     | 28/60 [00:54<00:47,  1.49s/it]Loading dataset:  48%|████▊     | 29/60 [00:56<00:44,  1.44s/it]Loading dataset:  52%|█████▏    | 31/60 [01:00<00:48,  1.67s/it]Loading dataset:  53%|█████▎    | 32/60 [01:00<00:36,  1.30s/it]Loading dataset:  55%|█████▌    | 33/60 [01:01<00:37,  1.39s/it]Loading dataset:  57%|█████▋    | 34/60 [01:02<00:31,  1.19s/it]Loading dataset:  58%|█████▊    | 35/60 [01:08<01:04,  2.59s/it]Loading dataset:  65%|██████▌   | 39/60 [01:13<00:35,  1.68s/it]Loading dataset:  67%|██████▋   | 40/60 [01:14<00:30,  1.53s/it]Loading dataset:  70%|███████   | 42/60 [01:15<00:21,  1.18s/it]Loading dataset:  72%|███████▏  | 43/60 [01:17<00:23,  1.36s/it]Loading dataset:  73%|███████▎  | 44/60 [01:21<00:33,  2.08s/it]Loading dataset:  78%|███████▊  | 47/60 [01:23<00:16,  1.29s/it]Loading dataset:  80%|████████  | 48/60 [01:24<00:16,  1.35s/it]Loading dataset:  82%|████████▏ | 49/60 [01:29<00:21,  1.99s/it]Loading dataset:  85%|████████▌ | 51/60 [01:31<00:14,  1.66s/it]Loading dataset:  88%|████████▊ | 53/60 [01:33<00:09,  1.41s/it]Loading dataset:  90%|█████████ | 54/60 [01:36<00:10,  1.72s/it]Loading dataset:  93%|█████████▎| 56/60 [01:37<00:05,  1.42s/it]Loading dataset:  95%|█████████▌| 57/60 [01:38<00:03,  1.31s/it]Loading dataset:  97%|█████████▋| 58/60 [01:44<00:04,  2.22s/it]Loading dataset: 100%|██████████| 60/60 [01:44<00:00,  1.74s/it]240 60
epoch 1/500 
epoch 1 average loss: 0.9288
epoch 2/500 epoch 2 average loss: 0.7725
saved new best metric model
current epoch: 2 current lung dice: 0.6114 best mean dice: 0.6114  at epoch: 2
epoch 3/500 epoch 3 average loss: 0.6761
epoch 4/500 epoch 4 average loss: 0.6107
saved new best metric model
current epoch: 4 current lung dice: 0.6393 best mean dice: 0.6393  at epoch: 4
epoch 5/500 epoch 5 average loss: 0.5622
epoch 6/500 epoch 6 average loss: 0.5234
saved new best metric model
current epoch: 6 current lung dice: 0.6627 best mean dice: 0.6627  at epoch: 6
epoch 7/500 epoch 7 average loss: 0.4857
epoch 8/500 epoch 8 average loss: 0.4527
saved new best metric model
current epoch: 8 current lung dice: 0.6830 best mean dice: 0.6830  at epoch: 8
epoch 9/500 epoch 9 average loss: 0.4087
epoch 10/500 epoch 10 average loss: 0.3632
saved new best metric model
current epoch: 10 current lung dice: 0.7817 best mean dice: 0.7817  at epoch: 10
epoch 11/500 epoch 11 average loss: 0.3316
epoch 12/500 epoch 12 average loss: 0.2926
saved new best metric model
current epoch: 12 current lung dice: 0.8438 best mean dice: 0.8438  at epoch: 12
epoch 13/500 epoch 13 average loss: 0.2734
epoch 14/500 epoch 14 average loss: 0.2495
saved new best metric model
current epoch: 14 current lung dice: 0.8499 best mean dice: 0.8499  at epoch: 14
epoch 15/500 epoch 15 average loss: 0.2350
epoch 16/500 epoch 16 average loss: 0.2241
saved new best metric model
current epoch: 16 current lung dice: 0.8519 best mean dice: 0.8519  at epoch: 16
epoch 17/500 epoch 17 average loss: 0.2110
epoch 18/500 epoch 18 average loss: 0.2056
current epoch: 18 current lung dice: 0.8296 best mean dice: 0.8519  at epoch: 16
epoch 19/500 epoch 19 average loss: 0.2003
epoch 20/500 epoch 20 average loss: 0.1896
saved new best metric model
current epoch: 20 current lung dice: 0.8639 best mean dice: 0.8639  at epoch: 20
epoch 21/500 epoch 21 average loss: 0.1456
epoch 22/500 epoch 22 average loss: 0.0845
saved new best metric model
current epoch: 22 current lung dice: 0.8799 best mean dice: 0.8799  at epoch: 22
epoch 23/500 epoch 23 average loss: 0.0916
epoch 24/500 epoch 24 average loss: 0.0816
current epoch: 24 current lung dice: 0.8628 best mean dice: 0.8799  at epoch: 22
epoch 25/500 epoch 25 average loss: 0.0743
epoch 26/500 epoch 26 average loss: 0.0766
current epoch: 26 current lung dice: 0.8555 best mean dice: 0.8799  at epoch: 22
epoch 27/500 epoch 27 average loss: 0.0737
epoch 28/500 epoch 28 average loss: 0.0701
current epoch: 28 current lung dice: 0.8765 best mean dice: 0.8799  at epoch: 22
epoch 29/500 epoch 29 average loss: 0.0700
epoch 30/500 epoch 30 average loss: 0.0689
saved new best metric model
current epoch: 30 current lung dice: 0.8879 best mean dice: 0.8879  at epoch: 30
epoch 31/500 epoch 31 average loss: 0.0668
epoch 32/500 epoch 32 average loss: 0.0674
current epoch: 32 current lung dice: 0.8872 best mean dice: 0.8879  at epoch: 30
epoch 33/500 epoch 33 average loss: 0.0703
epoch 34/500 epoch 34 average loss: 0.0697
current epoch: 34 current lung dice: 0.8810 best mean dice: 0.8879  at epoch: 30
epoch 35/500 epoch 35 average loss: 0.0649
epoch 36/500 epoch 36 average loss: 0.0626
saved new best metric model
current epoch: 36 current lung dice: 0.8973 best mean dice: 0.8973  at epoch: 36
epoch 37/500 epoch 37 average loss: 0.0721
epoch 38/500 epoch 38 average loss: 0.0658
current epoch: 38 current lung dice: 0.8917 best mean dice: 0.8973  at epoch: 36
epoch 39/500 epoch 39 average loss: 0.0642
epoch 40/500 epoch 40 average loss: 0.0621
current epoch: 40 current lung dice: 0.8922 best mean dice: 0.8973  at epoch: 36
epoch 41/500 epoch 41 average loss: 0.0620
epoch 42/500 epoch 42 average loss: 0.0632
current epoch: 42 current lung dice: 0.8893 best mean dice: 0.8973  at epoch: 36
epoch 43/500 epoch 43 average loss: 0.0597
epoch 44/500 epoch 44 average loss: 0.0617
current epoch: 44 current lung dice: 0.8947 best mean dice: 0.8973  at epoch: 36
epoch 45/500 epoch 45 average loss: 0.0638
epoch 46/500 epoch 46 average loss: 0.0622
current epoch: 46 current lung dice: 0.8934 best mean dice: 0.8973  at epoch: 36
epoch 47/500 epoch 47 average loss: 0.0621
epoch 48/500 epoch 48 average loss: 0.0688
current epoch: 48 current lung dice: 0.8929 best mean dice: 0.8973  at epoch: 36
epoch 49/500 epoch 49 average loss: 0.0640
epoch 50/500 epoch 50 average loss: 0.0624
current epoch: 50 current lung dice: 0.8897 best mean dice: 0.8973  at epoch: 36
epoch 51/500 epoch 51 average loss: 0.0594
epoch 52/500 epoch 52 average loss: 0.0618
current epoch: 52 current lung dice: 0.8887 best mean dice: 0.8973  at epoch: 36
epoch 53/500 epoch 53 average loss: 0.0611
epoch 54/500 epoch 54 average loss: 0.0602
current epoch: 54 current lung dice: 0.8955 best mean dice: 0.8973  at epoch: 36
epoch 55/500 epoch 55 average loss: 0.0586
epoch 56/500 epoch 56 average loss: 0.0590
current epoch: 56 current lung dice: 0.8899 best mean dice: 0.8973  at epoch: 36
epoch 57/500 epoch 57 average loss: 0.0611
epoch 58/500 epoch 58 average loss: 0.0613
current epoch: 58 current lung dice: 0.8920 best mean dice: 0.8973  at epoch: 36
epoch 59/500 epoch 59 average loss: 0.0583
epoch 60/500 epoch 60 average loss: 0.0572
current epoch: 60 current lung dice: 0.8953 best mean dice: 0.8973  at epoch: 36
epoch 61/500 epoch 61 average loss: 0.0575
epoch 62/500 epoch 62 average loss: 0.0569
current epoch: 62 current lung dice: 0.8962 best mean dice: 0.8973  at epoch: 36
epoch 63/500 epoch 63 average loss: 0.0591
epoch 64/500 epoch 64 average loss: 0.0597
current epoch: 64 current lung dice: 0.8940 best mean dice: 0.8973  at epoch: 36
epoch 65/500 epoch 65 average loss: 0.0567
epoch 66/500 epoch 66 average loss: 0.0563
current epoch: 66 current lung dice: 0.8454 best mean dice: 0.8973  at epoch: 36
epoch 67/500 epoch 67 average loss: 0.0578
epoch 68/500 epoch 68 average loss: 0.0563
saved new best metric model
current epoch: 68 current lung dice: 0.9001 best mean dice: 0.9001  at epoch: 68
epoch 69/500 epoch 69 average loss: 0.0583
epoch 70/500 epoch 70 average loss: 0.0599
current epoch: 70 current lung dice: 0.8973 best mean dice: 0.9001  at epoch: 68
epoch 71/500 epoch 71 average loss: 0.0593
epoch 72/500 epoch 72 average loss: 0.0559
current epoch: 72 current lung dice: 0.8993 best mean dice: 0.9001  at epoch: 68
epoch 73/500 epoch 73 average loss: 0.0588
epoch 74/500 epoch 74 average loss: 0.0576
current epoch: 74 current lung dice: 0.8929 best mean dice: 0.9001  at epoch: 68
epoch 75/500 epoch 75 average loss: 0.0553
epoch 76/500 epoch 76 average loss: 0.0565
current epoch: 76 current lung dice: 0.8933 best mean dice: 0.9001  at epoch: 68
epoch 77/500 epoch 77 average loss: 0.0558
epoch 78/500 epoch 78 average loss: 0.0555
current epoch: 78 current lung dice: 0.8994 best mean dice: 0.9001  at epoch: 68
epoch 79/500 epoch 79 average loss: 0.0586
epoch 80/500 epoch 80 average loss: 0.0577
saved new best metric model
current epoch: 80 current lung dice: 0.9024 best mean dice: 0.9024  at epoch: 80
epoch 81/500 epoch 81 average loss: 0.0541
epoch 82/500 epoch 82 average loss: 0.0556
current epoch: 82 current lung dice: 0.8942 best mean dice: 0.9024  at epoch: 80
epoch 83/500 epoch 83 average loss: 0.0548
epoch 84/500 epoch 84 average loss: 0.0543
saved new best metric model
current epoch: 84 current lung dice: 0.9025 best mean dice: 0.9025  at epoch: 84
epoch 85/500 epoch 85 average loss: 0.0572
epoch 86/500 epoch 86 average loss: 0.0585
current epoch: 86 current lung dice: 0.8996 best mean dice: 0.9025  at epoch: 84
epoch 87/500 epoch 87 average loss: 0.0552
epoch 88/500 epoch 88 average loss: 0.0559
current epoch: 88 current lung dice: 0.8941 best mean dice: 0.9025  at epoch: 84
epoch 89/500 epoch 89 average loss: 0.0568
epoch 90/500 epoch 90 average loss: 0.0549
current epoch: 90 current lung dice: 0.8673 best mean dice: 0.9025  at epoch: 84
epoch 91/500 epoch 91 average loss: 0.0607
epoch 92/500 epoch 92 average loss: 0.0553
saved new best metric model
current epoch: 92 current lung dice: 0.9028 best mean dice: 0.9028  at epoch: 92
epoch 93/500 epoch 93 average loss: 0.0532
epoch 94/500 epoch 94 average loss: 0.0545
current epoch: 94 current lung dice: 0.9020 best mean dice: 0.9028  at epoch: 92
epoch 95/500 epoch 95 average loss: 0.0537
epoch 96/500 epoch 96 average loss: 0.0536
current epoch: 96 current lung dice: 0.8903 best mean dice: 0.9028  at epoch: 92
epoch 97/500 epoch 97 average loss: 0.0544
epoch 98/500 epoch 98 average loss: 0.0560
current epoch: 98 current lung dice: 0.8920 best mean dice: 0.9028  at epoch: 92
epoch 99/500 epoch 99 average loss: 0.0547
epoch 100/500 epoch 100 average loss: 0.0551
current epoch: 100 current lung dice: 0.9006 best mean dice: 0.9028  at epoch: 92
epoch 101/500 epoch 101 average loss: 0.0549
epoch 102/500 epoch 102 average loss: 0.0527
current epoch: 102 current lung dice: 0.9026 best mean dice: 0.9028  at epoch: 92
epoch 103/500 epoch 103 average loss: 0.0540
epoch 104/500 epoch 104 average loss: 0.0552
current epoch: 104 current lung dice: 0.8934 best mean dice: 0.9028  at epoch: 92
epoch 105/500 epoch 105 average loss: 0.0543
epoch 106/500 epoch 106 average loss: 0.0561
current epoch: 106 current lung dice: 0.8967 best mean dice: 0.9028  at epoch: 92
epoch 107/500 epoch 107 average loss: 0.0533
epoch 108/500 epoch 108 average loss: 0.0531
current epoch: 108 current lung dice: 0.8950 best mean dice: 0.9028  at epoch: 92
epoch 109/500 epoch 109 average loss: 0.0519
epoch 110/500 epoch 110 average loss: 0.0530
current epoch: 110 current lung dice: 0.8975 best mean dice: 0.9028  at epoch: 92
epoch 111/500 epoch 111 average loss: 0.0562
epoch 112/500 epoch 112 average loss: 0.0541
current epoch: 112 current lung dice: 0.8856 best mean dice: 0.9028  at epoch: 92
epoch 113/500 epoch 113 average loss: 0.0529
epoch 114/500 epoch 114 average loss: 0.0528
current epoch: 114 current lung dice: 0.9011 best mean dice: 0.9028  at epoch: 92
epoch 115/500 epoch 115 average loss: 0.0540
epoch 116/500 epoch 116 average loss: 0.0533
current epoch: 116 current lung dice: 0.8928 best mean dice: 0.9028  at epoch: 92
epoch 117/500 epoch 117 average loss: 0.0526
epoch 118/500 epoch 118 average loss: 0.0522
current epoch: 118 current lung dice: 0.8994 best mean dice: 0.9028  at epoch: 92
epoch 119/500 epoch 119 average loss: 0.0556
epoch 120/500 epoch 120 average loss: 0.0529
current epoch: 120 current lung dice: 0.8959 best mean dice: 0.9028  at epoch: 92
epoch 121/500 epoch 121 average loss: 0.0535
epoch 122/500 epoch 122 average loss: 0.0535
current epoch: 122 current lung dice: 0.8982 best mean dice: 0.9028  at epoch: 92
epoch 123/500 epoch 123 average loss: 0.0525
epoch 124/500 epoch 124 average loss: 0.0521
current epoch: 124 current lung dice: 0.8981 best mean dice: 0.9028  at epoch: 92
epoch 125/500 epoch 125 average loss: 0.0517
epoch 126/500 epoch 126 average loss: 0.0551
current epoch: 126 current lung dice: 0.8924 best mean dice: 0.9028  at epoch: 92
epoch 127/500 epoch 127 average loss: 0.0510
epoch 128/500 epoch 128 average loss: 0.0512
current epoch: 128 current lung dice: 0.8957 best mean dice: 0.9028  at epoch: 92
epoch 129/500 epoch 129 average loss: 0.0526
epoch 130/500 epoch 130 average loss: 0.0511
saved new best metric model
current epoch: 130 current lung dice: 0.9050 best mean dice: 0.9050  at epoch: 130
epoch 131/500 epoch 131 average loss: 0.0554
epoch 132/500 epoch 132 average loss: 0.0513
current epoch: 132 current lung dice: 0.8909 best mean dice: 0.9050  at epoch: 130
epoch 133/500 epoch 133 average loss: 0.0513
epoch 134/500 epoch 134 average loss: 0.0532
current epoch: 134 current lung dice: 0.9038 best mean dice: 0.9050  at epoch: 130
epoch 135/500 epoch 135 average loss: 0.0524
epoch 136/500 epoch 136 average loss: 0.0534
current epoch: 136 current lung dice: 0.8914 best mean dice: 0.9050  at epoch: 130
epoch 137/500 epoch 137 average loss: 0.0516
epoch 138/500 epoch 138 average loss: 0.0509
current epoch: 138 current lung dice: 0.8982 best mean dice: 0.9050  at epoch: 130
epoch 139/500 epoch 139 average loss: 0.0534
epoch 140/500 epoch 140 average loss: 0.0583
current epoch: 140 current lung dice: 0.8978 best mean dice: 0.9050  at epoch: 130
epoch 141/500 epoch 141 average loss: 0.0511
epoch 142/500 epoch 142 average loss: 0.0512
current epoch: 142 current lung dice: 0.8869 best mean dice: 0.9050  at epoch: 130
epoch 143/500 epoch 143 average loss: 0.0535
epoch 144/500 epoch 144 average loss: 0.0521
current epoch: 144 current lung dice: 0.8995 best mean dice: 0.9050  at epoch: 130
epoch 145/500 epoch 145 average loss: 0.0526
epoch 146/500 epoch 146 average loss: 0.0536
current epoch: 146 current lung dice: 0.9036 best mean dice: 0.9050  at epoch: 130
epoch 147/500 epoch 147 average loss: 0.0512
epoch 148/500 epoch 148 average loss: 0.0509
saved new best metric model
current epoch: 148 current lung dice: 0.9058 best mean dice: 0.9058  at epoch: 148
epoch 149/500 epoch 149 average loss: 0.0503
epoch 150/500 epoch 150 average loss: 0.0526
current epoch: 150 current lung dice: 0.9045 best mean dice: 0.9058  at epoch: 148
epoch 151/500 epoch 151 average loss: 0.0515
epoch 152/500 epoch 152 average loss: 0.0528
current epoch: 152 current lung dice: 0.9027 best mean dice: 0.9058  at epoch: 148
epoch 153/500 epoch 153 average loss: 0.0507
epoch 154/500 epoch 154 average loss: 0.0506
current epoch: 154 current lung dice: 0.8975 best mean dice: 0.9058  at epoch: 148
epoch 155/500 epoch 155 average loss: 0.0512
epoch 156/500 epoch 156 average loss: 0.0520
current epoch: 156 current lung dice: 0.8957 best mean dice: 0.9058  at epoch: 148
epoch 157/500 epoch 157 average loss: 0.0501
epoch 158/500 epoch 158 average loss: 0.0499
current epoch: 158 current lung dice: 0.8996 best mean dice: 0.9058  at epoch: 148
epoch 159/500 epoch 159 average loss: 0.0508
epoch 160/500 epoch 160 average loss: 0.0527
current epoch: 160 current lung dice: 0.9012 best mean dice: 0.9058  at epoch: 148
epoch 161/500 epoch 161 average loss: 0.0506
epoch 162/500 epoch 162 average loss: 0.0499
current epoch: 162 current lung dice: 0.8953 best mean dice: 0.9058  at epoch: 148
epoch 163/500 epoch 163 average loss: 0.0549
epoch 164/500 epoch 164 average loss: 0.0504
current epoch: 164 current lung dice: 0.8957 best mean dice: 0.9058  at epoch: 148
epoch 165/500 epoch 165 average loss: 0.0506
epoch 166/500 epoch 166 average loss: 0.0510
current epoch: 166 current lung dice: 0.8922 best mean dice: 0.9058  at epoch: 148
epoch 167/500 epoch 167 average loss: 0.0500
epoch 168/500 epoch 168 average loss: 0.0498
current epoch: 168 current lung dice: 0.8919 best mean dice: 0.9058  at epoch: 148
epoch 169/500 epoch 169 average loss: 0.0508
epoch 170/500 epoch 170 average loss: 0.0519
current epoch: 170 current lung dice: 0.8974 best mean dice: 0.9058  at epoch: 148
epoch 171/500 epoch 171 average loss: 0.0504
epoch 172/500 epoch 172 average loss: 0.0494
current epoch: 172 current lung dice: 0.9016 best mean dice: 0.9058  at epoch: 148
epoch 173/500 epoch 173 average loss: 0.0510
epoch 174/500 epoch 174 average loss: 0.0514
current epoch: 174 current lung dice: 0.8956 best mean dice: 0.9058  at epoch: 148
epoch 175/500 epoch 175 average loss: 0.0510
epoch 176/500 epoch 176 average loss: 0.0510
current epoch: 176 current lung dice: 0.8865 best mean dice: 0.9058  at epoch: 148
epoch 177/500 epoch 177 average loss: 0.0508
epoch 178/500 epoch 178 average loss: 0.0506
current epoch: 178 current lung dice: 0.9031 best mean dice: 0.9058  at epoch: 148
epoch 179/500 epoch 179 average loss: 0.0499
epoch 180/500 epoch 180 average loss: 0.0507
current epoch: 180 current lung dice: 0.8962 best mean dice: 0.9058  at epoch: 148
epoch 181/500 epoch 181 average loss: 0.0511
epoch 182/500 epoch 182 average loss: 0.0492
current epoch: 182 current lung dice: 0.9015 best mean dice: 0.9058  at epoch: 148
epoch 183/500 epoch 183 average loss: 0.0489
epoch 184/500 epoch 184 average loss: 0.0518
current epoch: 184 current lung dice: 0.8913 best mean dice: 0.9058  at epoch: 148
epoch 185/500 epoch 185 average loss: 0.0503
epoch 186/500 epoch 186 average loss: 0.0491
current epoch: 186 current lung dice: 0.9001 best mean dice: 0.9058  at epoch: 148
epoch 187/500 epoch 187 average loss: 0.0497
epoch 188/500 epoch 188 average loss: 0.0503
current epoch: 188 current lung dice: 0.8925 best mean dice: 0.9058  at epoch: 148
epoch 189/500 epoch 189 average loss: 0.0488
epoch 190/500 epoch 190 average loss: 0.0506
current epoch: 190 current lung dice: 0.9024 best mean dice: 0.9058  at epoch: 148
epoch 191/500 epoch 191 average loss: 0.0514
epoch 192/500 epoch 192 average loss: 0.0491
current epoch: 192 current lung dice: 0.8963 best mean dice: 0.9058  at epoch: 148
epoch 193/500 epoch 193 average loss: 0.0499
epoch 194/500 epoch 194 average loss: 0.0499
current epoch: 194 current lung dice: 0.8981 best mean dice: 0.9058  at epoch: 148
epoch 195/500 epoch 195 average loss: 0.0484
epoch 196/500 epoch 196 average loss: 0.0525
current epoch: 196 current lung dice: 0.8910 best mean dice: 0.9058  at epoch: 148
epoch 197/500 epoch 197 average loss: 0.0510
epoch 198/500 epoch 198 average loss: 0.0490
current epoch: 198 current lung dice: 0.8964 best mean dice: 0.9058  at epoch: 148
epoch 199/500 epoch 199 average loss: 0.0493
epoch 200/500 epoch 200 average loss: 0.0507
current epoch: 200 current lung dice: 0.8993 best mean dice: 0.9058  at epoch: 148
epoch 201/500 epoch 201 average loss: 0.0493
epoch 202/500 epoch 202 average loss: 0.0487
current epoch: 202 current lung dice: 0.8979 best mean dice: 0.9058  at epoch: 148
epoch 203/500 epoch 203 average loss: 0.0493
epoch 204/500 epoch 204 average loss: 0.0483
current epoch: 204 current lung dice: 0.8984 best mean dice: 0.9058  at epoch: 148
epoch 205/500 epoch 205 average loss: 0.0488
epoch 206/500 epoch 206 average loss: 0.0504
current epoch: 206 current lung dice: 0.9013 best mean dice: 0.9058  at epoch: 148
epoch 207/500 epoch 207 average loss: 0.0485
epoch 208/500 epoch 208 average loss: 0.0512
current epoch: 208 current lung dice: 0.8935 best mean dice: 0.9058  at epoch: 148
epoch 209/500 epoch 209 average loss: 0.0499
epoch 210/500 epoch 210 average loss: 0.0481
current epoch: 210 current lung dice: 0.9039 best mean dice: 0.9058  at epoch: 148
epoch 211/500 epoch 211 average loss: 0.0482
epoch 212/500 epoch 212 average loss: 0.0488
current epoch: 212 current lung dice: 0.8983 best mean dice: 0.9058  at epoch: 148
epoch 213/500 epoch 213 average loss: 0.0490
epoch 214/500 epoch 214 average loss: 0.0502
current epoch: 214 current lung dice: 0.8942 best mean dice: 0.9058  at epoch: 148
epoch 215/500 epoch 215 average loss: 0.0486
epoch 216/500 epoch 216 average loss: 0.0485
current epoch: 216 current lung dice: 0.9007 best mean dice: 0.9058  at epoch: 148
epoch 217/500 epoch 217 average loss: 0.0512
epoch 218/500 epoch 218 average loss: 0.0500
current epoch: 218 current lung dice: 0.9048 best mean dice: 0.9058  at epoch: 148
epoch 219/500 epoch 219 average loss: 0.0480
epoch 220/500 epoch 220 average loss: 0.0484
current epoch: 220 current lung dice: 0.9018 best mean dice: 0.9058  at epoch: 148
epoch 221/500 epoch 221 average loss: 0.0478
epoch 222/500 epoch 222 average loss: 0.0489
current epoch: 222 current lung dice: 0.8996 best mean dice: 0.9058  at epoch: 148
epoch 223/500 epoch 223 average loss: 0.0501
epoch 224/500 epoch 224 average loss: 0.0477
current epoch: 224 current lung dice: 0.9047 best mean dice: 0.9058  at epoch: 148
epoch 225/500 epoch 225 average loss: 0.0485
epoch 226/500 epoch 226 average loss: 0.0497
current epoch: 226 current lung dice: 0.8978 best mean dice: 0.9058  at epoch: 148
epoch 227/500 epoch 227 average loss: 0.0488
epoch 228/500 epoch 228 average loss: 0.0484
current epoch: 228 current lung dice: 0.9031 best mean dice: 0.9058  at epoch: 148
epoch 229/500 epoch 229 average loss: 0.0481
epoch 230/500 epoch 230 average loss: 0.0464
current epoch: 230 current lung dice: 0.8999 best mean dice: 0.9058  at epoch: 148
epoch 231/500 epoch 231 average loss: 0.0487
epoch 232/500 epoch 232 average loss: 0.0484
current epoch: 232 current lung dice: 0.9009 best mean dice: 0.9058  at epoch: 148
epoch 233/500 epoch 233 average loss: 0.0483
epoch 234/500 epoch 234 average loss: 0.0486
current epoch: 234 current lung dice: 0.8984 best mean dice: 0.9058  at epoch: 148
epoch 235/500 epoch 235 average loss: 0.0472
epoch 236/500 epoch 236 average loss: 0.0484
current epoch: 236 current lung dice: 0.8915 best mean dice: 0.9058  at epoch: 148
epoch 237/500 epoch 237 average loss: 0.0487
epoch 238/500 epoch 238 average loss: 0.0478
current epoch: 238 current lung dice: 0.8972 best mean dice: 0.9058  at epoch: 148
epoch 239/500 epoch 239 average loss: 0.0506
epoch 240/500 epoch 240 average loss: 0.0474
current epoch: 240 current lung dice: 0.8947 best mean dice: 0.9058  at epoch: 148
epoch 241/500 epoch 241 average loss: 0.0476
epoch 242/500 epoch 242 average loss: 0.0482
current epoch: 242 current lung dice: 0.8982 best mean dice: 0.9058  at epoch: 148
epoch 243/500 epoch 243 average loss: 0.0488
epoch 244/500 epoch 244 average loss: 0.0479
current epoch: 244 current lung dice: 0.9010 best mean dice: 0.9058  at epoch: 148
epoch 245/500 epoch 245 average loss: 0.0473
epoch 246/500 epoch 246 average loss: 0.0472
current epoch: 246 current lung dice: 0.8994 best mean dice: 0.9058  at epoch: 148
epoch 247/500 epoch 247 average loss: 0.0492
epoch 248/500 epoch 248 average loss: 0.0489
current epoch: 248 current lung dice: 0.8962 best mean dice: 0.9058  at epoch: 148
epoch 249/500 epoch 249 average loss: 0.0491
epoch 250/500 epoch 250 average loss: 0.0466
current epoch: 250 current lung dice: 0.9003 best mean dice: 0.9058  at epoch: 148
epoch 251/500 epoch 251 average loss: 0.0467
epoch 252/500 epoch 252 average loss: 0.0476
current epoch: 252 current lung dice: 0.9002 best mean dice: 0.9058  at epoch: 148
epoch 253/500 epoch 253 average loss: 0.0521
epoch 254/500 epoch 254 average loss: 0.0494
current epoch: 254 current lung dice: 0.9023 best mean dice: 0.9058  at epoch: 148
epoch 255/500 epoch 255 average loss: 0.0476
epoch 256/500 epoch 256 average loss: 0.0481
current epoch: 256 current lung dice: 0.8991 best mean dice: 0.9058  at epoch: 148
epoch 257/500 epoch 257 average loss: 0.0484
epoch 258/500 epoch 258 average loss: 0.0474
current epoch: 258 current lung dice: 0.9008 best mean dice: 0.9058  at epoch: 148
epoch 259/500 epoch 259 average loss: 0.0470
epoch 260/500 epoch 260 average loss: 0.0473
current epoch: 260 current lung dice: 0.9012 best mean dice: 0.9058  at epoch: 148
epoch 261/500 epoch 261 average loss: 0.0473
epoch 262/500 epoch 262 average loss: 0.0473
current epoch: 262 current lung dice: 0.9004 best mean dice: 0.9058  at epoch: 148
epoch 263/500 epoch 263 average loss: 0.0476
epoch 264/500 epoch 264 average loss: 0.0494
current epoch: 264 current lung dice: 0.8983 best mean dice: 0.9058  at epoch: 148
epoch 265/500 epoch 265 average loss: 0.0484
epoch 266/500 epoch 266 average loss: 0.0463
current epoch: 266 current lung dice: 0.9030 best mean dice: 0.9058  at epoch: 148
epoch 267/500 epoch 267 average loss: 0.0477
epoch 268/500 epoch 268 average loss: 0.0473
current epoch: 268 current lung dice: 0.9045 best mean dice: 0.9058  at epoch: 148
epoch 269/500 epoch 269 average loss: 0.0473
epoch 270/500 epoch 270 average loss: 0.0489
current epoch: 270 current lung dice: 0.8973 best mean dice: 0.9058  at epoch: 148
epoch 271/500 epoch 271 average loss: 0.0470
epoch 272/500 epoch 272 average loss: 0.0474
current epoch: 272 current lung dice: 0.9011 best mean dice: 0.9058  at epoch: 148
epoch 273/500 epoch 273 average loss: 0.0494
epoch 274/500 epoch 274 average loss: 0.0490
current epoch: 274 current lung dice: 0.8971 best mean dice: 0.9058  at epoch: 148
epoch 275/500 epoch 275 average loss: 0.0483
epoch 276/500 epoch 276 average loss: 0.0481
current epoch: 276 current lung dice: 0.8926 best mean dice: 0.9058  at epoch: 148
epoch 277/500 epoch 277 average loss: 0.0481
epoch 278/500 epoch 278 average loss: 0.0476
current epoch: 278 current lung dice: 0.9039 best mean dice: 0.9058  at epoch: 148
epoch 279/500 epoch 279 average loss: 0.0469
epoch 280/500 epoch 280 average loss: 0.0460
saved new best metric model
current epoch: 280 current lung dice: 0.9063 best mean dice: 0.9063  at epoch: 280
epoch 281/500 epoch 281 average loss: 0.0457
epoch 282/500 epoch 282 average loss: 0.0473
current epoch: 282 current lung dice: 0.9035 best mean dice: 0.9063  at epoch: 280
epoch 283/500 epoch 283 average loss: 0.0485
epoch 284/500 epoch 284 average loss: 0.0486
current epoch: 284 current lung dice: 0.8974 best mean dice: 0.9063  at epoch: 280
epoch 285/500 epoch 285 average loss: 0.0469
epoch 286/500 epoch 286 average loss: 0.0466
current epoch: 286 current lung dice: 0.9008 best mean dice: 0.9063  at epoch: 280
epoch 287/500 epoch 287 average loss: 0.0471
epoch 288/500 epoch 288 average loss: 0.0456
current epoch: 288 current lung dice: 0.9014 best mean dice: 0.9063  at epoch: 280
epoch 289/500 epoch 289 average loss: 0.0464
epoch 290/500 epoch 290 average loss: 0.0461
current epoch: 290 current lung dice: 0.9028 best mean dice: 0.9063  at epoch: 280
epoch 291/500 epoch 291 average loss: 0.0464
epoch 292/500 epoch 292 average loss: 0.0485
current epoch: 292 current lung dice: 0.8959 best mean dice: 0.9063  at epoch: 280
epoch 293/500 epoch 293 average loss: 0.0477
epoch 294/500 epoch 294 average loss: 0.0469
current epoch: 294 current lung dice: 0.8997 best mean dice: 0.9063  at epoch: 280
epoch 295/500 epoch 295 average loss: 0.0489
epoch 296/500 epoch 296 average loss: 0.0471
current epoch: 296 current lung dice: 0.8967 best mean dice: 0.9063  at epoch: 280
epoch 297/500 epoch 297 average loss: 0.0469
epoch 298/500 epoch 298 average loss: 0.0476
current epoch: 298 current lung dice: 0.8961 best mean dice: 0.9063  at epoch: 280
epoch 299/500 epoch 299 average loss: 0.0467
epoch 300/500 epoch 300 average loss: 0.0458
current epoch: 300 current lung dice: 0.8976 best mean dice: 0.9063  at epoch: 280
epoch 301/500 epoch 301 average loss: 0.0499
epoch 302/500 epoch 302 average loss: 0.0496
current epoch: 302 current lung dice: 0.9020 best mean dice: 0.9063  at epoch: 280
epoch 303/500 epoch 303 average loss: 0.0462
epoch 304/500 epoch 304 average loss: 0.0466
current epoch: 304 current lung dice: 0.9035 best mean dice: 0.9063  at epoch: 280
epoch 305/500 epoch 305 average loss: 0.0462
epoch 306/500 epoch 306 average loss: 0.0467
current epoch: 306 current lung dice: 0.9015 best mean dice: 0.9063  at epoch: 280
epoch 307/500 epoch 307 average loss: 0.0459
epoch 308/500 epoch 308 average loss: 0.0465
current epoch: 308 current lung dice: 0.8994 best mean dice: 0.9063  at epoch: 280
epoch 309/500 epoch 309 average loss: 0.0468
epoch 310/500 epoch 310 average loss: 0.0461
current epoch: 310 current lung dice: 0.8922 best mean dice: 0.9063  at epoch: 280
epoch 311/500 epoch 311 average loss: 0.0466
epoch 312/500 epoch 312 average loss: 0.0461
current epoch: 312 current lung dice: 0.8985 best mean dice: 0.9063  at epoch: 280
epoch 313/500 epoch 313 average loss: 0.0476
epoch 314/500 epoch 314 average loss: 0.0467
current epoch: 314 current lung dice: 0.8936 best mean dice: 0.9063  at epoch: 280
epoch 315/500 epoch 315 average loss: 0.0458
epoch 316/500 epoch 316 average loss: 0.0461
current epoch: 316 current lung dice: 0.9018 best mean dice: 0.9063  at epoch: 280
epoch 317/500 epoch 317 average loss: 0.0461
epoch 318/500 epoch 318 average loss: 0.0474
current epoch: 318 current lung dice: 0.9001 best mean dice: 0.9063  at epoch: 280
epoch 319/500 epoch 319 average loss: 0.0461
epoch 320/500 epoch 320 average loss: 0.0461
current epoch: 320 current lung dice: 0.8998 best mean dice: 0.9063  at epoch: 280
epoch 321/500 epoch 321 average loss: 0.0455
epoch 322/500 epoch 322 average loss: 0.0479
current epoch: 322 current lung dice: 0.8982 best mean dice: 0.9063  at epoch: 280
epoch 323/500 epoch 323 average loss: 0.0478
epoch 324/500 epoch 324 average loss: 0.0470
current epoch: 324 current lung dice: 0.8997 best mean dice: 0.9063  at epoch: 280
epoch 325/500 epoch 325 average loss: 0.0463
epoch 326/500 epoch 326 average loss: 0.0479
current epoch: 326 current lung dice: 0.8985 best mean dice: 0.9063  at epoch: 280
epoch 327/500 epoch 327 average loss: 0.0477
epoch 328/500 epoch 328 average loss: 0.0473
current epoch: 328 current lung dice: 0.9053 best mean dice: 0.9063  at epoch: 280
epoch 329/500 epoch 329 average loss: 0.0472
epoch 330/500 epoch 330 average loss: 0.0477
current epoch: 330 current lung dice: 0.9019 best mean dice: 0.9063  at epoch: 280
epoch 331/500 epoch 331 average loss: 0.0462
epoch 332/500 epoch 332 average loss: 0.0464
current epoch: 332 current lung dice: 0.9038 best mean dice: 0.9063  at epoch: 280
epoch 333/500 epoch 333 average loss: 0.0464
epoch 334/500 epoch 334 average loss: 0.0451
current epoch: 334 current lung dice: 0.8983 best mean dice: 0.9063  at epoch: 280
epoch 335/500 epoch 335 average loss: 0.0459
epoch 336/500 epoch 336 average loss: 0.0468
current epoch: 336 current lung dice: 0.9010 best mean dice: 0.9063  at epoch: 280
epoch 337/500 epoch 337 average loss: 0.0460
epoch 338/500 epoch 338 average loss: 0.0445
current epoch: 338 current lung dice: 0.9030 best mean dice: 0.9063  at epoch: 280
epoch 339/500 epoch 339 average loss: 0.0456
epoch 340/500 epoch 340 average loss: 0.0461
current epoch: 340 current lung dice: 0.8988 best mean dice: 0.9063  at epoch: 280
epoch 341/500 epoch 341 average loss: 0.0462
epoch 342/500 epoch 342 average loss: 0.0458
current epoch: 342 current lung dice: 0.8898 best mean dice: 0.9063  at epoch: 280
epoch 343/500 epoch 343 average loss: 0.0474
epoch 344/500 epoch 344 average loss: 0.0459
current epoch: 344 current lung dice: 0.9032 best mean dice: 0.9063  at epoch: 280
epoch 345/500 epoch 345 average loss: 0.0477
epoch 346/500 epoch 346 average loss: 0.0452
current epoch: 346 current lung dice: 0.9000 best mean dice: 0.9063  at epoch: 280
epoch 347/500 epoch 347 average loss: 0.0458
epoch 348/500 epoch 348 average loss: 0.0471
current epoch: 348 current lung dice: 0.9016 best mean dice: 0.9063  at epoch: 280
epoch 349/500 epoch 349 average loss: 0.0468
epoch 350/500 epoch 350 average loss: 0.0462
current epoch: 350 current lung dice: 0.9047 best mean dice: 0.9063  at epoch: 280
epoch 351/500 epoch 351 average loss: 0.0452
epoch 352/500 epoch 352 average loss: 0.0470
current epoch: 352 current lung dice: 0.8927 best mean dice: 0.9063  at epoch: 280
epoch 353/500 epoch 353 average loss: 0.0462
epoch 354/500 epoch 354 average loss: 0.0459
current epoch: 354 current lung dice: 0.9015 best mean dice: 0.9063  at epoch: 280
epoch 355/500 epoch 355 average loss: 0.0460
epoch 356/500 epoch 356 average loss: 0.0457
current epoch: 356 current lung dice: 0.9045 best mean dice: 0.9063  at epoch: 280
epoch 357/500 epoch 357 average loss: 0.0467
epoch 358/500 epoch 358 average loss: 0.0450
current epoch: 358 current lung dice: 0.8957 best mean dice: 0.9063  at epoch: 280
epoch 359/500 epoch 359 average loss: 0.0454
epoch 360/500 epoch 360 average loss: 0.0447
current epoch: 360 current lung dice: 0.9009 best mean dice: 0.9063  at epoch: 280
epoch 361/500 epoch 361 average loss: 0.0448
epoch 362/500 epoch 362 average loss: 0.0468
current epoch: 362 current lung dice: 0.9025 best mean dice: 0.9063  at epoch: 280
epoch 363/500 epoch 363 average loss: 0.0458
epoch 364/500 epoch 364 average loss: 0.0463
current epoch: 364 current lung dice: 0.8982 best mean dice: 0.9063  at epoch: 280
epoch 365/500 epoch 365 average loss: 0.0460
epoch 366/500 epoch 366 average loss: 0.0452
saved new best metric model
current epoch: 366 current lung dice: 0.9080 best mean dice: 0.9080  at epoch: 366
epoch 367/500 epoch 367 average loss: 0.0444
epoch 368/500 epoch 368 average loss: 0.0451
current epoch: 368 current lung dice: 0.9054 best mean dice: 0.9080  at epoch: 366
epoch 369/500 epoch 369 average loss: 0.0462
epoch 370/500 epoch 370 average loss: 0.0451
current epoch: 370 current lung dice: 0.9061 best mean dice: 0.9080  at epoch: 366
epoch 371/500 epoch 371 average loss: 0.0456
epoch 372/500 epoch 372 average loss: 0.0462
saved new best metric model
current epoch: 372 current lung dice: 0.9123 best mean dice: 0.9123  at epoch: 372
epoch 373/500 epoch 373 average loss: 0.0464
epoch 374/500 epoch 374 average loss: 0.0450
current epoch: 374 current lung dice: 0.8997 best mean dice: 0.9123  at epoch: 372
epoch 375/500 epoch 375 average loss: 0.0459
epoch 376/500 epoch 376 average loss: 0.0446
current epoch: 376 current lung dice: 0.9083 best mean dice: 0.9123  at epoch: 372
epoch 377/500 epoch 377 average loss: 0.0453
epoch 378/500 epoch 378 average loss: 0.0457
current epoch: 378 current lung dice: 0.8946 best mean dice: 0.9123  at epoch: 372
epoch 379/500 epoch 379 average loss: 0.0455
epoch 380/500 epoch 380 average loss: 0.0457
current epoch: 380 current lung dice: 0.8957 best mean dice: 0.9123  at epoch: 372
epoch 381/500 epoch 381 average loss: 0.0451
epoch 382/500 epoch 382 average loss: 0.0450
current epoch: 382 current lung dice: 0.8970 best mean dice: 0.9123  at epoch: 372
epoch 383/500 epoch 383 average loss: 0.0449
epoch 384/500 epoch 384 average loss: 0.0476
current epoch: 384 current lung dice: 0.9062 best mean dice: 0.9123  at epoch: 372
epoch 385/500 epoch 385 average loss: 0.0455
epoch 386/500 epoch 386 average loss: 0.0466
current epoch: 386 current lung dice: 0.8984 best mean dice: 0.9123  at epoch: 372
epoch 387/500 epoch 387 average loss: 0.0448
epoch 388/500 epoch 388 average loss: 0.0456
current epoch: 388 current lung dice: 0.8985 best mean dice: 0.9123  at epoch: 372
epoch 389/500 epoch 389 average loss: 0.0451
epoch 390/500 epoch 390 average loss: 0.0446
current epoch: 390 current lung dice: 0.9036 best mean dice: 0.9123  at epoch: 372
epoch 391/500 epoch 391 average loss: 0.0447
epoch 392/500 epoch 392 average loss: 0.0471
current epoch: 392 current lung dice: 0.9051 best mean dice: 0.9123  at epoch: 372
epoch 393/500 epoch 393 average loss: 0.0473
epoch 394/500 epoch 394 average loss: 0.0455
current epoch: 394 current lung dice: 0.9023 best mean dice: 0.9123  at epoch: 372
epoch 395/500 epoch 395 average loss: 0.0464
epoch 396/500 epoch 396 average loss: 0.0452
current epoch: 396 current lung dice: 0.9040 best mean dice: 0.9123  at epoch: 372
epoch 397/500 epoch 397 average loss: 0.0470
epoch 398/500 epoch 398 average loss: 0.0459
current epoch: 398 current lung dice: 0.9026 best mean dice: 0.9123  at epoch: 372
epoch 399/500 epoch 399 average loss: 0.0445
epoch 400/500 epoch 400 average loss: 0.0446
current epoch: 400 current lung dice: 0.8988 best mean dice: 0.9123  at epoch: 372
epoch 401/500 epoch 401 average loss: 0.0474
epoch 402/500 epoch 402 average loss: 0.0460
current epoch: 402 current lung dice: 0.8986 best mean dice: 0.9123  at epoch: 372
epoch 403/500 epoch 403 average loss: 0.0451
epoch 404/500 epoch 404 average loss: 0.0440
current epoch: 404 current lung dice: 0.9012 best mean dice: 0.9123  at epoch: 372
epoch 405/500 epoch 405 average loss: 0.0440
epoch 406/500 epoch 406 average loss: 0.0447
current epoch: 406 current lung dice: 0.9014 best mean dice: 0.9123  at epoch: 372
epoch 407/500 epoch 407 average loss: 0.0444
epoch 408/500 epoch 408 average loss: 0.0444
current epoch: 408 current lung dice: 0.8984 best mean dice: 0.9123  at epoch: 372
epoch 409/500 epoch 409 average loss: 0.0446
epoch 410/500 epoch 410 average loss: 0.0445
current epoch: 410 current lung dice: 0.8982 best mean dice: 0.9123  at epoch: 372
epoch 411/500 epoch 411 average loss: 0.0444
epoch 412/500 epoch 412 average loss: 0.0443
current epoch: 412 current lung dice: 0.8980 best mean dice: 0.9123  at epoch: 372
epoch 413/500 epoch 413 average loss: 0.0451
epoch 414/500 epoch 414 average loss: 0.0457
current epoch: 414 current lung dice: 0.8999 best mean dice: 0.9123  at epoch: 372
epoch 415/500 epoch 415 average loss: 0.0447
epoch 416/500 epoch 416 average loss: 0.0439
current epoch: 416 current lung dice: 0.8972 best mean dice: 0.9123  at epoch: 372
epoch 417/500 epoch 417 average loss: 0.0451
epoch 418/500 epoch 418 average loss: 0.0446
current epoch: 418 current lung dice: 0.9089 best mean dice: 0.9123  at epoch: 372
epoch 419/500 epoch 419 average loss: 0.0451
epoch 420/500 epoch 420 average loss: 0.0446
current epoch: 420 current lung dice: 0.8990 best mean dice: 0.9123  at epoch: 372
epoch 421/500 epoch 421 average loss: 0.0438
epoch 422/500 epoch 422 average loss: 0.0441
current epoch: 422 current lung dice: 0.9010 best mean dice: 0.9123  at epoch: 372
epoch 423/500 epoch 423 average loss: 0.0452
epoch 424/500 epoch 424 average loss: 0.0439
current epoch: 424 current lung dice: 0.8966 best mean dice: 0.9123  at epoch: 372
epoch 425/500 epoch 425 average loss: 0.0481
epoch 426/500 epoch 426 average loss: 0.0467
current epoch: 426 current lung dice: 0.9028 best mean dice: 0.9123  at epoch: 372
epoch 427/500 epoch 427 average loss: 0.0446
epoch 428/500 epoch 428 average loss: 0.0456
current epoch: 428 current lung dice: 0.9044 best mean dice: 0.9123  at epoch: 372
epoch 429/500 epoch 429 average loss: 0.0452
epoch 430/500 epoch 430 average loss: 0.0443
current epoch: 430 current lung dice: 0.9015 best mean dice: 0.9123  at epoch: 372
epoch 431/500 epoch 431 average loss: 0.0437
epoch 432/500 epoch 432 average loss: 0.0441
current epoch: 432 current lung dice: 0.8991 best mean dice: 0.9123  at epoch: 372
epoch 433/500 epoch 433 average loss: 0.0460
epoch 434/500 epoch 434 average loss: 0.0458
current epoch: 434 current lung dice: 0.9028 best mean dice: 0.9123  at epoch: 372
epoch 435/500 epoch 435 average loss: 0.0452
epoch 436/500 epoch 436 average loss: 0.0442
current epoch: 436 current lung dice: 0.9051 best mean dice: 0.9123  at epoch: 372
epoch 437/500 epoch 437 average loss: 0.0433
epoch 438/500 epoch 438 average loss: 0.0438
current epoch: 438 current lung dice: 0.9052 best mean dice: 0.9123  at epoch: 372
epoch 439/500 epoch 439 average loss: 0.0439
epoch 440/500 epoch 440 average loss: 0.0444
current epoch: 440 current lung dice: 0.8899 best mean dice: 0.9123  at epoch: 372
epoch 441/500 epoch 441 average loss: 0.0450
epoch 442/500 epoch 442 average loss: 0.0450
current epoch: 442 current lung dice: 0.8978 best mean dice: 0.9123  at epoch: 372
epoch 443/500 epoch 443 average loss: 0.0440
epoch 444/500 epoch 444 average loss: 0.0437
current epoch: 444 current lung dice: 0.9003 best mean dice: 0.9123  at epoch: 372
epoch 445/500 epoch 445 average loss: 0.0446
epoch 446/500 epoch 446 average loss: 0.0425
current epoch: 446 current lung dice: 0.8975 best mean dice: 0.9123  at epoch: 372
epoch 447/500 epoch 447 average loss: 0.0435
epoch 448/500 epoch 448 average loss: 0.0442
current epoch: 448 current lung dice: 0.9042 best mean dice: 0.9123  at epoch: 372
epoch 449/500 epoch 449 average loss: 0.0440
epoch 450/500 epoch 450 average loss: 0.0426
current epoch: 450 current lung dice: 0.9054 best mean dice: 0.9123  at epoch: 372
epoch 451/500 epoch 451 average loss: 0.0431
epoch 452/500 epoch 452 average loss: 0.0428
current epoch: 452 current lung dice: 0.9005 best mean dice: 0.9123  at epoch: 372
epoch 453/500 epoch 453 average loss: 0.0439
epoch 454/500 epoch 454 average loss: 0.0441
current epoch: 454 current lung dice: 0.9047 best mean dice: 0.9123  at epoch: 372
epoch 455/500 epoch 455 average loss: 0.0461
epoch 456/500 epoch 456 average loss: 0.0433
current epoch: 456 current lung dice: 0.9061 best mean dice: 0.9123  at epoch: 372
epoch 457/500 epoch 457 average loss: 0.0430
epoch 458/500 epoch 458 average loss: 0.0444
current epoch: 458 current lung dice: 0.9024 best mean dice: 0.9123  at epoch: 372
epoch 459/500 epoch 459 average loss: 0.0440
epoch 460/500 epoch 460 average loss: 0.0434
current epoch: 460 current lung dice: 0.9014 best mean dice: 0.9123  at epoch: 372
epoch 461/500 epoch 461 average loss: 0.0432
epoch 462/500 epoch 462 average loss: 0.0418
current epoch: 462 current lung dice: 0.9056 best mean dice: 0.9123  at epoch: 372
epoch 463/500 epoch 463 average loss: 0.0425
epoch 464/500 epoch 464 average loss: 0.0421
current epoch: 464 current lung dice: 0.9058 best mean dice: 0.9123  at epoch: 372
epoch 465/500 epoch 465 average loss: 0.0408
epoch 466/500 epoch 466 average loss: 0.0416
current epoch: 466 current lung dice: 0.9059 best mean dice: 0.9123  at epoch: 372
epoch 467/500 epoch 467 average loss: 0.0413
epoch 468/500 epoch 468 average loss: 0.0422
current epoch: 468 current lung dice: 0.9073 best mean dice: 0.9123  at epoch: 372
epoch 469/500 epoch 469 average loss: 0.0423
epoch 470/500 epoch 470 average loss: 0.0420
current epoch: 470 current lung dice: 0.9074 best mean dice: 0.9123  at epoch: 372
epoch 471/500 epoch 471 average loss: 0.0415
epoch 472/500 epoch 472 average loss: 0.0412
current epoch: 472 current lung dice: 0.9086 best mean dice: 0.9123  at epoch: 372
epoch 473/500 epoch 473 average loss: 0.0442
epoch 474/500 epoch 474 average loss: 0.0443
saved new best metric model
current epoch: 474 current lung dice: 0.9124 best mean dice: 0.9124  at epoch: 474
epoch 475/500 epoch 475 average loss: 0.0420
epoch 476/500 epoch 476 average loss: 0.0406
current epoch: 476 current lung dice: 0.9121 best mean dice: 0.9124  at epoch: 474
epoch 477/500 epoch 477 average loss: 0.0401
epoch 478/500 epoch 478 average loss: 0.0404
current epoch: 478 current lung dice: 0.9029 best mean dice: 0.9124  at epoch: 474
epoch 479/500 epoch 479 average loss: 0.0403
epoch 480/500 epoch 480 average loss: 0.0414
current epoch: 480 current lung dice: 0.9052 best mean dice: 0.9124  at epoch: 474
epoch 481/500 epoch 481 average loss: 0.0411
epoch 482/500 epoch 482 average loss: 0.0417
current epoch: 482 current lung dice: 0.9039 best mean dice: 0.9124  at epoch: 474
epoch 483/500 epoch 483 average loss: 0.0422
epoch 484/500 epoch 484 average loss: 0.0420
current epoch: 484 current lung dice: 0.9107 best mean dice: 0.9124  at epoch: 474
epoch 485/500 epoch 485 average loss: 0.0410
epoch 486/500 epoch 486 average loss: 0.0394
current epoch: 486 current lung dice: 0.9034 best mean dice: 0.9124  at epoch: 474
epoch 487/500 epoch 487 average loss: 0.0404
epoch 488/500 epoch 488 average loss: 0.0417
current epoch: 488 current lung dice: 0.9043 best mean dice: 0.9124  at epoch: 474
epoch 489/500 epoch 489 average loss: 0.0409
epoch 490/500 epoch 490 average loss: 0.0403
current epoch: 490 current lung dice: 0.9076 best mean dice: 0.9124  at epoch: 474
epoch 491/500 epoch 491 average loss: 0.0397
epoch 492/500 epoch 492 average loss: 0.0418
current epoch: 492 current lung dice: 0.9060 best mean dice: 0.9124  at epoch: 474
epoch 493/500 epoch 493 average loss: 0.0399
epoch 494/500 epoch 494 average loss: 0.0398
current epoch: 494 current lung dice: 0.9113 best mean dice: 0.9124  at epoch: 474
epoch 495/500 epoch 495 average loss: 0.0399
epoch 496/500 epoch 496 average loss: 0.0395
current epoch: 496 current lung dice: 0.9117 best mean dice: 0.9124  at epoch: 474
epoch 497/500 epoch 497 average loss: 0.0387
epoch 498/500 epoch 498 average loss: 0.0385
current epoch: 498 current lung dice: 0.9056 best mean dice: 0.9124  at epoch: 474
epoch 499/500 epoch 499 average loss: 0.0395
epoch 500/500 epoch 500 average loss: 0.0382
saved new best metric model
current epoch: 500 current lung dice: 0.9162 best mean dice: 0.9162  at epoch: 500
