{'image_adc': '/app/liucd/deeplearn_dec/DL_dec/data_adc/zunyi/Mixed/2022_10_20_1650366_ADC2_0000_0.nii.gz', 'image_dce': '/app/liucd/deeplearn_dec/DL_dec/data/zunyi/Mixed/2022_10_20_1650366_+C2_0000_0.nii.gz', 'clinical': [3.0, 1.0, 2.0, 0.0, 0.0, 0.2], 'label': 0}
691 619 1310
Loading dataset:   0%|          | 0/69 [00:00<?, ?it/s]Loading dataset:   1%|▏         | 1/69 [00:00<00:21,  3.15it/s]Loading dataset:   3%|▎         | 2/69 [00:02<01:29,  1.34s/it]Loading dataset:  25%|██▍       | 17/69 [00:04<00:11,  4.66it/s]Loading dataset:  49%|████▉     | 34/69 [00:04<00:03,  9.85it/s]Loading dataset: 100%|██████████| 69/69 [00:04<00:00, 14.69it/s]
Loading dataset:   0%|          | 0/61 [00:00<?, ?it/s]Loading dataset:   2%|▏         | 1/61 [00:01<01:03,  1.05s/it]Loading dataset:  44%|████▍     | 27/61 [00:01<00:01, 24.02it/s]Loading dataset:  54%|█████▍    | 33/61 [00:01<00:01, 23.23it/s]Loading dataset:  61%|██████    | 37/61 [00:02<00:01, 14.89it/s]Loading dataset: 100%|██████████| 61/61 [00:02<00:00, 24.46it/s]
output:  torch.Size([8, 2])
epoch 1 average  train loss: 0.6288
saved new best metric model
current epoch: 1 current accuracy: 0.6866 current AUC: 0.5809 best accuracy: 0.5809 at epoch 1
epoch 2 average  train loss: 0.6415
saved new best metric model
current epoch: 2 current accuracy: 0.6575 current AUC: 0.6561 best accuracy: 0.6561 at epoch 2
epoch 3 average  train loss: 0.6015
current epoch: 3 current accuracy: 0.4426 current AUC: 0.4815 best accuracy: 0.6561 at epoch 2
epoch 4 average  train loss: 0.5803
current epoch: 4 current accuracy: 0.6882 current AUC: 0.6044 best accuracy: 0.6561 at epoch 2
epoch 5 average  train loss: 0.5764
current epoch: 5 current accuracy: 0.6850 current AUC: 0.6096 best accuracy: 0.6561 at epoch 2
epoch 6 average  train loss: 0.5757
current epoch: 6 current accuracy: 0.6866 current AUC: 0.6034 best accuracy: 0.6561 at epoch 2
epoch 7 average  train loss: 0.6053
current epoch: 7 current accuracy: 0.7044 current AUC: 0.5963 best accuracy: 0.6561 at epoch 2
epoch 8 average  train loss: 0.5769
current epoch: 8 current accuracy: 0.7108 current AUC: 0.6056 best accuracy: 0.6561 at epoch 2
epoch 9 average  train loss: 0.5568
current epoch: 9 current accuracy: 0.7044 current AUC: 0.6159 best accuracy: 0.6561 at epoch 2
epoch 10 average  train loss: 0.5859
current epoch: 10 current accuracy: 0.6866 current AUC: 0.5331 best accuracy: 0.6561 at epoch 2
epoch 11 average  train loss: 0.5482
current epoch: 11 current accuracy: 0.7011 current AUC: 0.6175 best accuracy: 0.6561 at epoch 2
epoch 12 average  train loss: 0.5638
current epoch: 12 current accuracy: 0.6979 current AUC: 0.6181 best accuracy: 0.6561 at epoch 2
epoch 13 average  train loss: 0.5440
saved new best metric model
current epoch: 13 current accuracy: 0.7173 current AUC: 0.6854 best accuracy: 0.6854 at epoch 13
epoch 14 average  train loss: 0.5474
saved new best metric model
current epoch: 14 current accuracy: 0.7302 current AUC: 0.7365 best accuracy: 0.7365 at epoch 14
epoch 15 average  train loss: 0.5465
current epoch: 15 current accuracy: 0.7060 current AUC: 0.6990 best accuracy: 0.7365 at epoch 14
epoch 16 average  train loss: 0.5724
current epoch: 16 current accuracy: 0.7124 current AUC: 0.6904 best accuracy: 0.7365 at epoch 14
epoch 17 average  train loss: 0.5903
current epoch: 17 current accuracy: 0.6947 current AUC: 0.6625 best accuracy: 0.7365 at epoch 14
epoch 18 average  train loss: 0.6153
current epoch: 18 current accuracy: 0.6866 current AUC: 0.7343 best accuracy: 0.7365 at epoch 14
epoch 19 average  train loss: 0.6175
saved new best metric model
current epoch: 19 current accuracy: 0.6882 current AUC: 0.7466 best accuracy: 0.7466 at epoch 19
epoch 20 average  train loss: 0.6121
current epoch: 20 current accuracy: 0.6866 current AUC: 0.7421 best accuracy: 0.7466 at epoch 19
epoch 21 average  train loss: 0.6135
saved new best metric model
current epoch: 21 current accuracy: 0.6866 current AUC: 0.7466 best accuracy: 0.7466 at epoch 21
epoch 22 average  train loss: 0.6144
saved new best metric model
current epoch: 22 current accuracy: 0.6882 current AUC: 0.7467 best accuracy: 0.7467 at epoch 22
epoch 23 average  train loss: 0.6110
saved new best metric model
current epoch: 23 current accuracy: 0.6866 current AUC: 0.7537 best accuracy: 0.7537 at epoch 23
epoch 24 average  train loss: 0.6076
current epoch: 24 current accuracy: 0.6866 current AUC: 0.7480 best accuracy: 0.7537 at epoch 23
{'image_adc': '/app/liucd/deeplearn_dec/DL_dec/data_adc/zunyi/Mixed/2022_10_20_1650366_ADC2_0000_0.nii.gz', 'image_dce': '/app/liucd/deeplearn_dec/DL_dec/data/zunyi/Mixed/2022_10_20_1650366_+C2_0000_0.nii.gz', 'clinical': [3.0, 1.0, 2.0, 0.0, 0.0, 0.2], 'label': 0}
691 619 1310
Loading dataset:   0%|          | 0/69 [00:00<?, ?it/s]Loading dataset:   1%|▏         | 1/69 [00:00<00:20,  3.36it/s]Loading dataset:   3%|▎         | 2/69 [00:02<01:17,  1.16s/it]Loading dataset:  25%|██▍       | 17/69 [00:03<00:09,  5.43it/s]Loading dataset:  49%|████▉     | 34/69 [00:04<00:03, 10.65it/s]Loading dataset: 100%|██████████| 69/69 [00:04<00:00, 16.29it/s]
Loading dataset:   0%|          | 0/61 [00:00<?, ?it/s]Loading dataset:   2%|▏         | 1/61 [00:00<00:56,  1.05it/s]Loading dataset:  44%|████▍     | 27/61 [00:01<00:01, 25.22it/s]Loading dataset:  54%|█████▍    | 33/61 [00:01<00:01, 19.79it/s]Loading dataset:  59%|█████▉    | 36/61 [00:02<00:01, 13.89it/s]Loading dataset: 100%|██████████| 61/61 [00:02<00:00, 24.18it/s]
output:  torch.Size([8, 2])
epoch 1 average  train loss: 0.6481
saved new best metric model
current epoch: 1 current accuracy: 0.6866 current AUC: 0.6187 best accuracy: 0.6187 at epoch 1
epoch 2 average  train loss: 0.5986
saved new best metric model
current epoch: 2 current accuracy: 0.6866 current AUC: 0.6355 best accuracy: 0.6355 at epoch 2
epoch 3 average  train loss: 0.5892
current epoch: 3 current accuracy: 0.6850 current AUC: 0.5389 best accuracy: 0.6355 at epoch 2
epoch 4 average  train loss: 0.5704
saved new best metric model
current epoch: 4 current accuracy: 0.7124 current AUC: 0.6997 best accuracy: 0.6997 at epoch 4
epoch 5 average  train loss: 0.5880
current epoch: 5 current accuracy: 0.6866 current AUC: 0.6473 best accuracy: 0.6997 at epoch 4
epoch 6 average  train loss: 0.5743
current epoch: 6 current accuracy: 0.6882 current AUC: 0.6666 best accuracy: 0.6997 at epoch 4
epoch 7 average  train loss: 0.5694
saved new best metric model
current epoch: 7 current accuracy: 0.7011 current AUC: 0.7149 best accuracy: 0.7149 at epoch 7
epoch 8 average  train loss: 0.5301
current epoch: 8 current accuracy: 0.6898 current AUC: 0.7129 best accuracy: 0.7149 at epoch 7
epoch 9 average  train loss: 0.5422
saved new best metric model
current epoch: 9 current accuracy: 0.7302 current AUC: 0.7235 best accuracy: 0.7235 at epoch 9
epoch 10 average  train loss: 0.5572
current epoch: 10 current accuracy: 0.7060 current AUC: 0.6750 best accuracy: 0.7235 at epoch 9
epoch 11 average  train loss: 0.5425
current epoch: 11 current accuracy: 0.6866 current AUC: 0.6994 best accuracy: 0.7235 at epoch 9
epoch 12 average  train loss: 0.5641
saved new best metric model
current epoch: 12 current accuracy: 0.7092 current AUC: 0.7381 best accuracy: 0.7381 at epoch 12
epoch 13 average  train loss: 0.5235
current epoch: 13 current accuracy: 0.6979 current AUC: 0.7101 best accuracy: 0.7381 at epoch 12
epoch 14 average  train loss: 0.5270
current epoch: 14 current accuracy: 0.6898 current AUC: 0.7018 best accuracy: 0.7381 at epoch 12
epoch 15 average  train loss: 0.5227
saved new best metric model
current epoch: 15 current accuracy: 0.6850 current AUC: 0.7455 best accuracy: 0.7455 at epoch 15
epoch 16 average  train loss: 0.5126
saved new best metric model
current epoch: 16 current accuracy: 0.6931 current AUC: 0.7746 best accuracy: 0.7746 at epoch 16
epoch 17 average  train loss: 0.5341
current epoch: 17 current accuracy: 0.7092 current AUC: 0.7560 best accuracy: 0.7746 at epoch 16
epoch 18 average  train loss: 0.5011
current epoch: 18 current accuracy: 0.6931 current AUC: 0.7513 best accuracy: 0.7746 at epoch 16
epoch 19 average  train loss: 0.5175
current epoch: 19 current accuracy: 0.7076 current AUC: 0.7723 best accuracy: 0.7746 at epoch 16
epoch 20 average  train loss: 0.5128
current epoch: 20 current accuracy: 0.7399 current AUC: 0.7492 best accuracy: 0.7746 at epoch 16
epoch 21 average  train loss: 0.5132
current epoch: 21 current accuracy: 0.7383 current AUC: 0.7437 best accuracy: 0.7746 at epoch 16
epoch 22 average  train loss: 0.5084
current epoch: 22 current accuracy: 0.6947 current AUC: 0.7566 best accuracy: 0.7746 at epoch 16
epoch 23 average  train loss: 0.4924
current epoch: 23 current accuracy: 0.7480 current AUC: 0.7654 best accuracy: 0.7746 at epoch 16
epoch 24 average  train loss: 0.5161
current epoch: 24 current accuracy: 0.7011 current AUC: 0.7255 best accuracy: 0.7746 at epoch 16
epoch 25 average  train loss: 0.4927
current epoch: 25 current accuracy: 0.7076 current AUC: 0.7064 best accuracy: 0.7746 at epoch 16
epoch 26 average  train loss: 0.5109
current epoch: 26 current accuracy: 0.7011 current AUC: 0.7710 best accuracy: 0.7746 at epoch 16
epoch 27 average  train loss: 0.4835
saved new best metric model
current epoch: 27 current accuracy: 0.7108 current AUC: 0.7784 best accuracy: 0.7784 at epoch 27
epoch 28 average  train loss: 0.4723
saved new best metric model
current epoch: 28 current accuracy: 0.7544 current AUC: 0.7943 best accuracy: 0.7943 at epoch 28
epoch 29 average  train loss: 0.4668
current epoch: 29 current accuracy: 0.7528 current AUC: 0.7844 best accuracy: 0.7943 at epoch 28
epoch 30 average  train loss: 0.4862
saved new best metric model
current epoch: 30 current accuracy: 0.7690 current AUC: 0.7999 best accuracy: 0.7999 at epoch 30
epoch 31 average  train loss: 0.4840
current epoch: 31 current accuracy: 0.7722 current AUC: 0.7966 best accuracy: 0.7999 at epoch 30
epoch 32 average  train loss: 0.4651
saved new best metric model
current epoch: 32 current accuracy: 0.8029 current AUC: 0.8064 best accuracy: 0.8064 at epoch 32
epoch 33 average  train loss: 0.4543
current epoch: 33 current accuracy: 0.7011 current AUC: 0.8029 best accuracy: 0.8064 at epoch 32
epoch 34 average  train loss: 0.4691
current epoch: 34 current accuracy: 0.7044 current AUC: 0.7637 best accuracy: 0.8064 at epoch 32
epoch 35 average  train loss: 0.4777
saved new best metric model
current epoch: 35 current accuracy: 0.7011 current AUC: 0.8111 best accuracy: 0.8111 at epoch 35
epoch 36 average  train loss: 0.4458
current epoch: 36 current accuracy: 0.7658 current AUC: 0.7926 best accuracy: 0.8111 at epoch 35
epoch 37 average  train loss: 0.4405
current epoch: 37 current accuracy: 0.6963 current AUC: 0.7814 best accuracy: 0.8111 at epoch 35
epoch 38 average  train loss: 0.4519
current epoch: 38 current accuracy: 0.7480 current AUC: 0.7847 best accuracy: 0.8111 at epoch 35
epoch 39 average  train loss: 0.4225
current epoch: 39 current accuracy: 0.7690 current AUC: 0.8011 best accuracy: 0.8111 at epoch 35
epoch 40 average  train loss: 0.4531
current epoch: 40 current accuracy: 0.7738 current AUC: 0.8073 best accuracy: 0.8111 at epoch 35
epoch 41 average  train loss: 0.4291
current epoch: 41 current accuracy: 0.7173 current AUC: 0.7969 best accuracy: 0.8111 at epoch 35
epoch 42 average  train loss: 0.4337
current epoch: 42 current accuracy: 0.7803 current AUC: 0.8011 best accuracy: 0.8111 at epoch 35
epoch 43 average  train loss: 0.4257
saved new best metric model
current epoch: 43 current accuracy: 0.7092 current AUC: 0.8158 best accuracy: 0.8158 at epoch 43
epoch 44 average  train loss: 0.4286
current epoch: 44 current accuracy: 0.7528 current AUC: 0.8047 best accuracy: 0.8158 at epoch 43
epoch 45 average  train loss: 0.4223
saved new best metric model
current epoch: 45 current accuracy: 0.7351 current AUC: 0.8242 best accuracy: 0.8242 at epoch 45
epoch 46 average  train loss: 0.4153
saved new best metric model
current epoch: 46 current accuracy: 0.7851 current AUC: 0.8294 best accuracy: 0.8294 at epoch 46
epoch 47 average  train loss: 0.4098
current epoch: 47 current accuracy: 0.7819 current AUC: 0.8046 best accuracy: 0.8294 at epoch 46
epoch 48 average  train loss: 0.4219
current epoch: 48 current accuracy: 0.7674 current AUC: 0.8192 best accuracy: 0.8294 at epoch 46
epoch 49 average  train loss: 0.4053
current epoch: 49 current accuracy: 0.7900 current AUC: 0.8125 best accuracy: 0.8294 at epoch 46
epoch 50 average  train loss: 0.3974
current epoch: 50 current accuracy: 0.7884 current AUC: 0.8072 best accuracy: 0.8294 at epoch 46
epoch 51 average  train loss: 0.4112
current epoch: 51 current accuracy: 0.7706 current AUC: 0.8131 best accuracy: 0.8294 at epoch 46
epoch 52 average  train loss: 0.4188
current epoch: 52 current accuracy: 0.7577 current AUC: 0.8062 best accuracy: 0.8294 at epoch 46
epoch 53 average  train loss: 0.3968
saved new best metric model
current epoch: 53 current accuracy: 0.7544 current AUC: 0.8295 best accuracy: 0.8295 at epoch 53
epoch 54 average  train loss: 0.4133
current epoch: 54 current accuracy: 0.7512 current AUC: 0.7951 best accuracy: 0.8295 at epoch 53
epoch 55 average  train loss: 0.3889
current epoch: 55 current accuracy: 0.7803 current AUC: 0.8120 best accuracy: 0.8295 at epoch 53
epoch 56 average  train loss: 0.4026
current epoch: 56 current accuracy: 0.7092 current AUC: 0.7939 best accuracy: 0.8295 at epoch 53
epoch 57 average  train loss: 0.4042
current epoch: 57 current accuracy: 0.7609 current AUC: 0.8099 best accuracy: 0.8295 at epoch 53
epoch 58 average  train loss: 0.3981
current epoch: 58 current accuracy: 0.7561 current AUC: 0.7954 best accuracy: 0.8295 at epoch 53
epoch 59 average  train loss: 0.3778
current epoch: 59 current accuracy: 0.7447 current AUC: 0.7877 best accuracy: 0.8295 at epoch 53
epoch 60 average  train loss: 0.3967
current epoch: 60 current accuracy: 0.7641 current AUC: 0.8051 best accuracy: 0.8295 at epoch 53
epoch 61 average  train loss: 0.3626
current epoch: 61 current accuracy: 0.7561 current AUC: 0.8036 best accuracy: 0.8295 at epoch 53
epoch 62 average  train loss: 0.3705
current epoch: 62 current accuracy: 0.7658 current AUC: 0.7930 best accuracy: 0.8295 at epoch 53
epoch 63 average  train loss: 0.3974
current epoch: 63 current accuracy: 0.7674 current AUC: 0.8049 best accuracy: 0.8295 at epoch 53
epoch 64 average  train loss: 0.3465
current epoch: 64 current accuracy: 0.7447 current AUC: 0.7990 best accuracy: 0.8295 at epoch 53
epoch 65 average  train loss: 0.3622
current epoch: 65 current accuracy: 0.7480 current AUC: 0.8083 best accuracy: 0.8295 at epoch 53
epoch 66 average  train loss: 0.3353
current epoch: 66 current accuracy: 0.7641 current AUC: 0.7916 best accuracy: 0.8295 at epoch 53
epoch 67 average  train loss: 0.3587
current epoch: 67 current accuracy: 0.7577 current AUC: 0.7754 best accuracy: 0.8295 at epoch 53
epoch 68 average  train loss: 0.3374
current epoch: 68 current accuracy: 0.7318 current AUC: 0.7935 best accuracy: 0.8295 at epoch 53
epoch 69 average  train loss: 0.3512
current epoch: 69 current accuracy: 0.7189 current AUC: 0.7918 best accuracy: 0.8295 at epoch 53
epoch 70 average  train loss: 0.3482
current epoch: 70 current accuracy: 0.7415 current AUC: 0.7939 best accuracy: 0.8295 at epoch 53
epoch 71 average  train loss: 0.3317
current epoch: 71 current accuracy: 0.7173 current AUC: 0.7960 best accuracy: 0.8295 at epoch 53
epoch 72 average  train loss: 0.3465
current epoch: 72 current accuracy: 0.7658 current AUC: 0.7950 best accuracy: 0.8295 at epoch 53
epoch 73 average  train loss: 0.3213
current epoch: 73 current accuracy: 0.7851 current AUC: 0.8163 best accuracy: 0.8295 at epoch 53
epoch 74 average  train loss: 0.3512
current epoch: 74 current accuracy: 0.7641 current AUC: 0.7999 best accuracy: 0.8295 at epoch 53
epoch 75 average  train loss: 0.3441
current epoch: 75 current accuracy: 0.7835 current AUC: 0.7811 best accuracy: 0.8295 at epoch 53
epoch 76 average  train loss: 0.3402
current epoch: 76 current accuracy: 0.7738 current AUC: 0.8073 best accuracy: 0.8295 at epoch 53
epoch 77 average  train loss: 0.2915
current epoch: 77 current accuracy: 0.7674 current AUC: 0.7931 best accuracy: 0.8295 at epoch 53
epoch 78 average  train loss: 0.3177
current epoch: 78 current accuracy: 0.6898 current AUC: 0.7853 best accuracy: 0.8295 at epoch 53
epoch 79 average  train loss: 0.3106
current epoch: 79 current accuracy: 0.7771 current AUC: 0.7865 best accuracy: 0.8295 at epoch 53
epoch 80 average  train loss: 0.3030
current epoch: 80 current accuracy: 0.7351 current AUC: 0.7698 best accuracy: 0.8295 at epoch 53
train completed, best_metric: 0.8295 at epoch: 53
